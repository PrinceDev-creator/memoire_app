<!DOCTYPE html>
<html>
<head>
    <title>Liste des Animations</title>
    <style>
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th {
            background: linear-gradient(90deg, #4f8cff 0%, #1e3c72 100%);
            color: #fff;
        }
        tr:nth-child(even) { background: #f9f9f9; }
        .search-bar {
            margin-bottom: 20px;
        }
        .search-bar input {
            padding: 6px;
            border-radius: 4px;
            border: 1px solid #aaa;
            width: 300px;
        }
    </style>
    <script>
    function filterTable() {
        var input = document.getElementById("searchInput");
        var filter = input.value.toLowerCase();
        var table = document.getElementById("animationTable");
        var trs = table.getElementsByTagName("tr");
        var columnSelect = document.getElementById("columnSelect");
        var colIndex = columnSelect.value;

        for (var i = 1; i < trs.length; i++) { // skip header
            var tds = trs[i].getElementsByTagName("td");
            var show = false;

            if (colIndex === "all") {
                // Recherche sur toutes les colonnes
                for (var j = 0; j < tds.length; j++) {
                    var txtValue = tds[j].textContent || tds[j].innerText;
                    if (txtValue.toLowerCase().indexOf(filter) > -1) {
                        show = true;
                        break;
                    }
                }
            } else {
                // Recherche sur une colonne spécifique
                var idx = parseInt(colIndex);
                if (tds[idx]) {
                    var txtValue = tds[idx].textContent || tds[idx].innerText;
                    if (txtValue.toLowerCase().indexOf(filter) > -1) {
                        show = true;
                    }
                }
            }
            trs[i].style.display = show ? "" : "none";
        }
    }

    // Pour filtrer aussi lors du changement de colonne
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById("columnSelect").addEventListener("change", filterTable);
    });
</script>
</head>
<body>
    <h1>Liste des Animations</h1>
   <div class="search-bar">
    <label for="columnSelect">Filtrer par :</label>
    <select id="columnSelect">
        <option value="all">Toutes les colonnes</option>
        <option value="0">Classe</option>
        <option value="1">Série</option>
        <option value="2">Groupe</option>
        <option value="3">École</option>
        <option value="4">Matière</option>
        <option value="5">Catégorie</option>
        <option value="6">Coefficient</option>
        <option value="7">Clé d'animation</option>
    </select>
    <input type="text" id="searchInput" onkeyup="filterTable()" placeholder="Tapez pour filtrer...">
</div>
    <table id="animationTable">
        <thead>
            <tr>
                <th>Classe</th>
                <th>Série</th>
                <th>Groupe</th>
                <th>École</th>
                <th>Matière</th>
                <th>Catégorie</th>
                <th>Coefficient</th>
                <th>Clé d'animation</th>
            </tr>
        </thead>
        <tbody>
            {% for animation in animations %}
            <tr>
                <td>{{ animation.level.name }}</td>
                <td>{{ animation.level.series }}</td>
                <td>{{ animation.level.group }}</td>
                <td>{{ animation.school.school_name }}</td>
                <td>{{ animation.subject.name }}</td>
                <td>{{ animation.subject.category }}</td>
                <td>{{ animation.coefficient }}</td>
                <td>{{ animation.animation_key }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="8">Aucune animation trouvée.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>